@model IEnumerable<StarProject.Models.Emp>
@{
    ViewData["Title"] = "員工列表";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>員工列表</h1>
    <a asp-action="Create" class="btn btn-primary">
        <i class="fas fa-plus"></i> 新增員工
    </a>
</div>

@* 成功訊息區塊 *@
@if (TempData["NewEmpCode"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <h4 class="alert-heading">
            <i class="fas fa-check-circle"></i> 新員工建立成功！
        </h4>
        <hr>
        <p class="mb-1">
            <strong>員工編號：</strong>@TempData["NewEmpCode"]<br>
            <strong>預設密碼：</strong><code>@TempData["TempPassword"]</code>
        </p>
        @if (TempData["EmailSent"] != null)
        {
            <div class="alert alert-info mt-2 mb-0">
                <i class="fas fa-envelope-check"></i>
                <strong>Email通知已發送</strong> - 員工將收到登入資訊
            </div>
        }
        @if (TempData["EmailError"] != null)
        {
            <div class="alert alert-warning mt-2 mb-0">
                <i class="fas fa-exclamation-triangle"></i>
                <strong>Email發送失敗：</strong>@TempData["EmailError"]
            </div>
        }
        @if (TempData["EmailNotSent"] != null)
        {
            <div class="alert alert-info mt-2 mb-0">
                <i class="fas fa-info-circle"></i>
                @TempData["EmailNotSent"]
            </div>
        }
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

@if (Model.Any())
{
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>@Html.DisplayNameFor(model => model.Name)</th>
                    <th>@Html.DisplayNameFor(model => model.EmpCode)</th>
                    <th>部門</th>
                    <th>職位</th>
                    <th>@Html.DisplayNameFor(model => model.HireDate)</th>
                    <th>@Html.DisplayNameFor(model => model.Status)</th>
                    <th class="text-center">操作</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@Html.DisplayFor(modelItem => item.Name)</td>
                        <td>
                            <span class="badge bg-secondary">@Html.DisplayFor(modelItem => item.EmpCode)</span>
                        </td>
                        <td>@Html.DisplayFor(modelItem => item.DeptNoNavigation.DeptName)</td>
                        <td>@Html.DisplayFor(modelItem => item.RoleNoNavigation.RoleName)</td>
                        <td>@Html.DisplayFor(modelItem => item.HireDate)</td>
                        <td>
                            @if (item.Status)
                            {
                                <span class="badge bg-success">在職</span>
                            }
                            else
                            {
                                <span class="badge bg-danger">離職</span>
                            }
                        </td>
                        <td class="text-center">
                            <div class="btn-group btn-group-sm" role="group">
                                <a asp-action="Details" asp-route-id="@item.No" class="btn btn-outline-info" title="檢視詳細">
                                    <i class="fas fa-eye"></i>
                                </a>
                                <a asp-action="Edit" asp-route-id="@item.No" class="btn btn-outline-primary" title="編輯">
                                    <i class="fas fa-edit"></i>
                                </a>
                                <a asp-action="Delete" asp-route-id="@item.No" class="btn btn-outline-danger" title="刪除">
                                    <i class="fas fa-trash"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
else
{
    <div class="text-center py-5">
        <i class="fas fa-users fa-3x text-muted mb-3"></i>
        <h4 class="text-muted">目前沒有員工資料</h4>
        <p class="text-muted">點擊上方「新增員工」按鈕來建立第一筆員工資料</p>
        <a asp-action="Create" class="btn btn-primary mt-3">
            <i class="fas fa-plus"></i> 立即新增員工
        </a>
    </div>
}