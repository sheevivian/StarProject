@{
    ViewData["Title"] = "星航基地後台系統";
}
<script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

<style>
    body {
        /* background-color: #000; /* 黑色背景 */ */
       /* /* background-image: url(https://cdn.pixabay.com/photo/2016/09/08/20/52/starry-sky-1655503_1280.jpg) */
         
    }
    </style>



    <!-- 第一列圖表 -->
<div class="container-fluid p-4">
    <div class="row g-8">
        <!-- 左側：商品 & 票券分析 -->
        <div class="col-md-6">
            
                <div class="cardsetting">
                    <h5 class="card-title text-center">商品營收分析</h5>
                    <div id="productChart" style="height:350px;"></div>
                    <br>
                <h5 class="card-title text-center">票券營收分析</h5>
                    <div id="ticketChart" style="height:350px; margin-top:20px;"></div>
                </div>

           
        </div>

        <!-- 右側：KPI + 活動報名 -->
        <div class="col-md-6">
            <div class="row g-4">
                <div class="col-6">
                    <div class="card shadow-sm text-center p-3 card-red text-light">
                        <i class="bi bi-box2-heart fs-1"></i>
                        <h5 class="card-title mt-2">庫存預警</h5>
                        <p class="card-text">5 項商品低庫存</p>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card shadow-sm text-center p-3 card-darkblue text-light">
                        <i class="bi bi-cart-check fs-1"></i>
                        <h5 class="card-title mt-2">本週訪客數</h5>
                        <p class="card-text">1200人</p>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card shadow-sm text-center p-3 card-yellow text-light">
                        <i class="bi bi-cash-coin fs-1"></i>
                        <h5 class="card-title mt-2">今日營收</h5>
                        <p class="card-text">$15,000</p>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card shadow-sm text-center p-3 card-blue text-light">
                        <i class="bi bi-people fs-1"></i>
                        <h5 class="card-title mt-2">新增會員數</h5>
                        <p class="card-text">20人</p>
                    </div>
                </div>
            </div>

            <!-- 活動報名柱狀圖 -->
            <div class="col-12 mt-4">
                <div class="card shadow">
                    <div class="card-body">
                        <h5 class="card-title text-center">活動報名人數</h5>
                        <canvas id="eventChart" style="height:300px;"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    
 
  
<!-- javascript-->
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- ECharts CDN -->



<script>
          

        // 商品
        var productChart = echarts.init(document.getElementById('productChart'));
        $.getJSON('/Chart/GetCategoryNestedData', function (res) {
            const blueColors = [ '#28004D','#4B0091','#000093','#2828FF','#004B97','#2894FF','#00E3E3','#A6FFFF'];

            res.counts.forEach((item, index) => {
                item.itemStyle = { color: blueColors[index % blueColors.length] };
            });

            res.revenues.forEach((item, index) => {
                item.itemStyle = { color: blueColors[index % blueColors.length] };
            });

            var option = {
                tooltip: { trigger: 'item' },
                             legend: {
        top: '90%',   // ✅ 這邊就是放在 option 裡面
        left: 'center'},
                series: [
                    {
                        name: '營收金額',
                        type: 'pie',
                        radius: [0, '40%'],
                        label: { position: 'inside' },
                        data: res.revenues
                    },

                    {
                        name: '銷售筆數',
                        type: 'pie',
                        radius: ['55%', '70%'],
                        label: { position: 'outside' },
                        data: res.counts
                    }
                ]
            };
            productChart.setOption(option);
        });

        // 票券
        var ticketChart = echarts.init(document.getElementById('ticketChart'));
        $.getJSON('/Chart/GetTicketCategoryData', function (res) {
            const redColors = ['#4F0202','#7A0101','#FF0505','#F25C5C','#FC9292','#F2B1B1','#FADEDE','#DBC5C5'];

            res.counts.forEach((item, index) => {
                item.itemStyle = { color: redColors[index % redColors.length] };
            });
            res.revenues.forEach((item, index) => {
                item.itemStyle = { color: redColors[index % redColors.length] };
            });

            var option = {
                tooltip: { trigger: 'item' },
                
                  legend: {
        top: '90%',   // ✅ 這邊就是放在 option 裡面
        left: 'center'},

                series: [
                    {
                        name: '銷售筆數',
                        type: 'pie',
                        radius: ['50%', '70%'],
                        label: { position: 'outside' },
                        data: res.counts
                    },
                    {
                        name: '營收金額',
                        type: 'pie',
                        radius: ['0%', '40%'],
                        label: { position: 'inside' },
                        data: res.revenues
                    }
                ]
            };
            ticketChart.setOption(option);
        });


          const ctx = document.getElementById('eventChart').getContext('2d');
    const eventChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['活動 A', '活動 B', '活動 C', '活動 D'], // X 軸活動名稱
            datasets: [{
                label: '報名人數',
                data: [120, 90, 150, 60], // 對應各活動報名人數
                backgroundColor: [
                    'rgba(54, 162, 235, 0.7)',
                    'rgba(75, 192, 192, 0.7)',
                    'rgba(255, 206, 86, 0.7)',
                    'rgba(255, 99, 132, 0.7)'
                ],
                borderColor: [
                    'rgba(54, 162, 235, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(255, 99, 132, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: false } // 不顯示右上圖例
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { stepSize: 20 }
                }
            }
        }
    });




    </script>
